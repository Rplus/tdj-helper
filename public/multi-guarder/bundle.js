var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function l(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function s(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function f(){return d(" ")}function p(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function h(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t){return""===t?null:+t}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function y(t,e,n,i){t.style.setProperty(e,n,i?"important":"")}let b,v;function $(){if(void 0===b){b=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){b=!0}}return b}function w(t){v=t}const _=[],k=[],E=[],M=[],C=Promise.resolve();let A=!1;function T(t){E.push(t)}let z=!1;const L=new Set;function X(){if(!z){z=!0;do{for(let t=0;t<_.length;t+=1){const e=_[t];w(e),W(e.$$)}for(w(null),_.length=0;k.length;)k.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];L.has(e)||(L.add(e),e())}E.length=0}while(_.length);for(;M.length;)M.pop()();A=!1,z=!1,L.clear()}}function W(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(T)}}const j=new Set;function B(t,e){-1===t.$$.dirty[0]&&(_.push(t),A||(A=!0,C.then(X)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function H(o,r,c,s,u,d,f,p=[-1]){const h=v;w(o);const g=o.$$={fragment:null,ctx:null,props:d,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(h?h.$$.context:[])),callbacks:n(),dirty:p,skip_bound:!1,root:r.target||h.$$.root};f&&f(g.root);let m=!1;if(g.ctx=c?c(o,r.props||{},((t,e,...n)=>{const i=n.length?n[0]:e;return g.ctx&&u(g.ctx[t],g.ctx[t]=i)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](i),m&&B(o,t)),e})):[],g.update(),m=!0,i(g.before_update),g.fragment=!!s&&s(g.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);g.fragment&&g.fragment.l(t),t.forEach(a)}else g.fragment&&g.fragment.c();r.intro&&((x=o.$$.fragment)&&x.i&&(j.delete(x),x.i(y))),function(t,n,o,r){const{fragment:c,on_mount:a,on_destroy:s,after_update:u}=t.$$;c&&c.m(n,o),r||T((()=>{const n=a.map(e).filter(l);s?s.push(...n):i(n),t.$$.on_mount=[]})),u.forEach(T)}(o,r.target,r.anchor,r.customElement),X()}var x,y;w(h)}function N(t,e,n){const i=t.slice();return i[18]=e[n],i[19]=e,i[20]=n,i}function O(t,e,n){const i=t.slice();return i[18]=e[n],i}function S(t,e,n){const i=t.slice();return i[23]=e[n],i}function P(t){let e,n;return{c(){e=u("div"),h(e,"class","dot--attacker svelte-it0tdi"),h(e,"data-title",n=t[23].title),y(e,"--x",t[23].x),y(e,"--y",t[23].y),y(e,"--bgc",t[23].color)},m(t,n){c(t,e,n)},p(t,i){16&i&&n!==(n=t[23].title)&&h(e,"data-title",n),16&i&&y(e,"--x",t[23].x),16&i&&y(e,"--y",t[23].y),16&i&&y(e,"--bgc",t[23].color)},d(t){t&&a(e)}}}function V(t){let e,n,i;return{c(){e=u("div"),h(e,"class","dot svelte-it0tdi"),h(e,"data-range",n=t[18].range),h(e,"data-title",i=t[18].title),y(e,"--x",t[18].x),y(e,"--y",t[18].y),y(e,"--bgc",t[18].color)},m(t,n){c(t,e,n)},p(t,l){4&l&&n!==(n=t[18].range)&&h(e,"data-range",n),4&l&&i!==(i=t[18].title)&&h(e,"data-title",i),4&l&&y(e,"--x",t[18].x),4&l&&y(e,"--y",t[18].y),4&l&&y(e,"--bgc",t[18].color)},d(t){t&&a(e)}}}function q(t){let e,n,l,o,s,y,b,v,$,w,_,k,E,M,C,A,T,z,L,X,W,j,B,H,N,O,S,P,V=t[18].title+"";function q(){t[6].call(v,t[19],t[20])}function I(){t[7].call(M,t[19],t[20])}function D(){t[8].call(X,t[19],t[20])}function F(){t[9].call(N,t[19],t[20])}return{c(){e=u("dt"),n=d(V),l=d(" - "),o=u("small"),o.textContent="護衛",s=u("dd"),y=u("label"),b=d("x:\n\t\t\t\t\t\t"),v=u("input"),w=f(),_=u("dd"),k=u("label"),E=d("y:\n\t\t\t\t\t\t"),M=u("input"),A=f(),T=u("dd"),z=u("label"),L=d("護衛範圍:\n\t\t\t\t\t\t"),X=u("input"),W=f(),j=u("dd"),B=u("label"),H=d("顏色:\n\t\t\t\t\t\t"),N=u("input"),O=f(),h(e,"class","svelte-it0tdi"),h(v,"type","number"),h(v,"max",$=t[0]-1),h(v,"min","0"),h(s,"class","svelte-it0tdi"),h(M,"type","number"),h(M,"max",C=t[0]-1),h(M,"min","0"),h(_,"class","svelte-it0tdi"),h(X,"type","number"),h(X,"max","3"),h(X,"min","0"),h(T,"class","svelte-it0tdi"),h(N,"type","color"),h(j,"class","svelte-it0tdi")},m(i,a){c(i,e,a),r(e,n),r(e,l),r(e,o),c(i,s,a),r(s,y),r(y,b),r(y,v),x(v,t[18].x),r(s,w),c(i,_,a),r(_,k),r(k,E),r(k,M),x(M,t[18].y),r(_,A),c(i,T,a),r(T,z),r(z,L),r(z,X),x(X,t[18].range),r(T,W),c(i,j,a),r(j,B),r(B,H),r(B,N),x(N,t[18].color),r(j,O),S||(P=[p(v,"input",q),p(M,"input",I),p(X,"input",D),p(N,"input",F)],S=!0)},p(e,i){t=e,4&i&&V!==(V=t[18].title+"")&&m(n,V),1&i&&$!==($=t[0]-1)&&h(v,"max",$),4&i&&g(v.value)!==t[18].x&&x(v,t[18].x),1&i&&C!==(C=t[0]-1)&&h(M,"max",C),4&i&&g(M.value)!==t[18].y&&x(M,t[18].y),4&i&&g(X.value)!==t[18].range&&x(X,t[18].range),4&i&&x(N,t[18].color)},d(t){t&&a(e),t&&a(s),t&&a(_),t&&a(T),t&&a(j),S=!1,i(P)}}}function I(e){let n,l,o,b,v,w,_,k,E,M,C,A,z,L,X,W,j,B,H,I,D,F,G,J,K,Q,R,U,Y,Z,tt,et,nt,it,lt,ot,rt,ct,at,st,ut,dt,ft,pt=e[1].title+"",ht=e[4],gt=[];for(let t=0;t<ht.length;t+=1)gt[t]=P(S(e,ht,t));let mt=e[2],xt=[];for(let t=0;t<mt.length;t+=1)xt[t]=V(O(e,mt,t));let yt=e[2],bt=[];for(let t=0;t<yt.length;t+=1)bt[t]=q(N(e,yt,t));return{c(){n=u("div"),l=u("h1"),l.innerHTML='<a href="../">../</a>\n\t天地劫M 多重護衛優先級判定模擬',o=f(),b=u("div"),v=u("div"),w=u("div"),k=f();for(let t=0;t<gt.length;t+=1)gt[t].c();E=f();for(let t=0;t<xt.length;t+=1)xt[t].c();C=f(),A=u("div"),A.innerHTML='圖中方格為攻擊者可站的位置<br/>\n底色對應護衛單位\n<br/> \n<br/> \n<details open=""><summary>== 護衛優先級 說明 ==</summary> \n<pre><u>規則一：判定各護衛與「被攻擊者」距離</u>\n離「被攻擊者」最近者，最優先護衛\n\n<u>規則二：判定各護衛與「攻擊者」距離</u>\n若有複數最近的護衛群，改判定各護衛與「攻擊者」距離\n※ 坦X：上場順序最先者\n\n<u>狀況-1</u>：坦X 距離攻擊者最近\n  則依正序護衛\n  (=&gt; 坦X護衛)\n\n<u>狀況-2</u>：坦X 距離攻擊者不是最近\n  比坦X更近的那堆中，依倒序護衛\n  (愈後上場者、護衛優先級愈高)</pre></details>',z=f(),L=u("hr"),X=f(),W=u("form"),j=u("fieldset"),B=u("legend"),B.textContent="自訂區塊",H=f(),I=u("dl");for(let t=0;t<bt.length;t+=1)bt[t].c();D=u("dt"),F=d(pt),G=d(" - "),J=u("small"),J.textContent="被攻擊目標",K=u("dd"),Q=u("label"),R=d("x:\n\t\t\t\t\t"),U=u("input"),Z=f(),tt=u("dd"),et=u("label"),nt=d("y:\n\t\t\t\t\t"),it=u("input"),ot=f(),rt=u("dt"),rt.textContent="格子數:\n\t\t\t",ct=u("dd"),at=u("input"),st=f(),ut=u("footer"),ut.innerHTML='<hr class="svelte-it0tdi"/>\n\t\t資料參考：\n\t\t<a href="https://www.bilibili.com/video/BV1VB4y1y7fh/" target="_blank" rel="noreferrer noopener">「天地劫」多T护卫机制 详解 @ bilibili by u/墨_源</a>',h(l,"class","svelte-it0tdi"),h(w,"class","dot attackee svelte-it0tdi"),h(w,"data-title",_=e[1].title),y(w,"--x",e[1].x),y(w,"--y",e[1].y),h(v,"class","map svelte-it0tdi"),y(v,"font-size",e[3]/e[0]+"px"),y(v,"height",e[3]+"px"),T((()=>e[5].call(v))),h(A,"class","intro"),h(L,"class","svelte-it0tdi"),h(b,"class","map-box svelte-it0tdi"),h(B,"class","svelte-it0tdi"),h(D,"class","svelte-it0tdi"),h(U,"type","number"),h(U,"max",Y=e[0]-1),h(U,"min","0"),h(K,"class","svelte-it0tdi"),h(it,"type","number"),h(it,"max",lt=e[0]-1),h(it,"min","0"),h(tt,"class","svelte-it0tdi"),h(rt,"class","svelte-it0tdi"),h(at,"type","number"),h(at,"min","4"),h(ct,"class","svelte-it0tdi"),h(j,"class","svelte-it0tdi"),h(W,"class","svelte-it0tdi"),h(ut,"class","info svelte-it0tdi"),h(n,"class","workspace svelte-it0tdi")},m(t,i){c(t,n,i),r(n,l),r(n,o),r(n,b),r(b,v),r(v,w),r(v,k);for(let t=0;t<gt.length;t+=1)gt[t].m(v,null);r(v,E);for(let t=0;t<xt.length;t+=1)xt[t].m(v,null);M=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=u("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const i=$();let l;return i?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",l=p(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{l=p(n.contentWindow,"resize",e)}),r(t,n),()=>{(i||l&&n.contentWindow)&&l(),a(n)}}(v,e[5].bind(v)),r(b,C),r(b,A),r(b,z),r(b,L),r(n,X),r(n,W),r(W,j),r(j,B),r(j,H),r(j,I);for(let t=0;t<bt.length;t+=1)bt[t].m(I,null);r(I,D),r(D,F),r(D,G),r(D,J),r(I,K),r(K,Q),r(Q,R),r(Q,U),x(U,e[1].x),r(K,Z),r(I,tt),r(tt,et),r(et,nt),r(et,it),x(it,e[1].y),r(tt,ot),r(I,rt),r(I,ct),r(ct,at),x(at,e[0]),r(n,st),r(n,ut),dt||(ft=[p(U,"input",e[10]),p(it,"input",e[11]),p(at,"input",e[12])],dt=!0)},p(t,[e]){if(2&e&&_!==(_=t[1].title)&&h(w,"data-title",_),2&e&&y(w,"--x",t[1].x),2&e&&y(w,"--y",t[1].y),16&e){let n;for(ht=t[4],n=0;n<ht.length;n+=1){const i=S(t,ht,n);gt[n]?gt[n].p(i,e):(gt[n]=P(i),gt[n].c(),gt[n].m(v,E))}for(;n<gt.length;n+=1)gt[n].d(1);gt.length=ht.length}if(4&e){let n;for(mt=t[2],n=0;n<mt.length;n+=1){const i=O(t,mt,n);xt[n]?xt[n].p(i,e):(xt[n]=V(i),xt[n].c(),xt[n].m(v,null))}for(;n<xt.length;n+=1)xt[n].d(1);xt.length=mt.length}if(9&e&&y(v,"font-size",t[3]/t[0]+"px"),8&e&&y(v,"height",t[3]+"px"),5&e){let n;for(yt=t[2],n=0;n<yt.length;n+=1){const i=N(t,yt,n);bt[n]?bt[n].p(i,e):(bt[n]=q(i),bt[n].c(),bt[n].m(I,D))}for(;n<bt.length;n+=1)bt[n].d(1);bt.length=yt.length}2&e&&pt!==(pt=t[1].title+"")&&m(F,pt),1&e&&Y!==(Y=t[0]-1)&&h(U,"max",Y),2&e&&g(U.value)!==t[1].x&&x(U,t[1].x),1&e&&lt!==(lt=t[0]-1)&&h(it,"max",lt),2&e&&g(it.value)!==t[1].y&&x(it,t[1].y),1&e&&g(at.value)!==t[0]&&x(at,t[0])},i:t,o:t,d(t){t&&a(n),s(gt,t),s(xt,t),M(),s(bt,t),dt=!1,i(ft)}}}function D(t,e,n){let i,l=6,o={index:10,order:10,title:"受",x:1,y:2},r=[{index:1,order:1,title:"坦1",x:0,y:3,range:2,color:"#ff9999"},{index:2,order:2,title:"坦2",x:2,y:3,range:3,color:"#99ff99"},{index:3,order:3,title:"坦3",x:3,y:2,range:2,color:"#9999ff"}],c=[],a={title:""};function s(t){let e=[],i=function(){let t=[],e=2*l;return r.forEach((n=>{if(n.range<n.distance)return null;e>=n.distance&&(e=n.distance,t[n.distance]||(t[n.distance]=[]),t[n.distance].push(n))})),t[e]}();for(let t=l-1;t>=0;t--)for(let n=l-1;n>=0;n--){let o=u(t,n,i);console.log({def:o}),e[t+n*l]={title:`${o.title}`,x:t,y:n,color:o.color}}n(4,c=e)}function u(t,e,n){if(!n||0===n.length)return a;if(1===n.length)return n[0];let i=2*l,o=999,r=0,c=n.map((n=>{let l=Math.abs(n.y-e)+Math.abs(n.x-t),{index:c,title:a,color:s}=n;return i>l&&(i=l),o>c&&(o=c),r<c&&(r=c),{index:c,title:a,distance:l,color:s}})),s=c.find((t=>t.index===o));return c.find((t=>t.index===r)),s.distance===i?s:c.filter((t=>t.distance<s.distance)).sort(((t,e)=>e.index-t.index))[0]}return t.$$.update=()=>{6&t.$$.dirty&&r.forEach((t=>{t.distance=Math.abs(t.y-o.y)+Math.abs(t.x-o.x)})),7&t.$$.dirty&&s()},[l,o,r,i,c,function(){i=this.clientWidth,n(3,i)},function(t,e){t[e].x=g(this.value),n(2,r)},function(t,e){t[e].y=g(this.value),n(2,r)},function(t,e){t[e].range=g(this.value),n(2,r)},function(t,e){t[e].color=this.value,n(2,r)},function(){o.x=g(this.value),n(1,o)},function(){o.y=g(this.value),n(1,o)},function(){l=g(this.value),n(0,l)}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),H(this,t,D,I,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
